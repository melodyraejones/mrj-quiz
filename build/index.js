(()=>{"use strict";const e=window.wp.element,t=window.wp.blockEditor,n=window.wp.components,o=window.wp.blocks,l=({label:t,value:o,onChange:l,help:a})=>{const[i,s]=(0,e.useState)(o.join("\n"));return(0,e.createElement)(n.BaseControl,{label:t,help:a},(0,e.createElement)("textarea",{value:i,onChange:e=>{const t=e.target.value;s(t);const n=t.split("\n").map((e=>e.trim())).filter((e=>e));l(n)},rows:10,cols:50,className:"components-textarea-control__input"}))},a="undefined"!=typeof mrjplugin_data&&Array.isArray(mrjplugin_data.personality_types)?mrjplugin_data.personality_types.map((e=>({label:e,value:e}))):[];console.log("Personality Types:",a),(0,o.registerBlockType)("mrjplugin/quiz",{title:"What's Your Wisdom Profile?",icon:"smiley",category:"common",attributes:{questions:{type:"array",default:[{question:"",choices:[{text:"",personalityType:"",imageUrl:""}],imageUrl:""}]},personalityTypes:{type:"array",default:[]}},edit:function({attributes:o,setAttributes:a}){const{questions:i,personalityTypes:s}=o;return(0,e.createElement)("div",{className:"mrj-quiz-edit-block"},(0,e.createElement)(l,{label:"Personality Types",help:"Enter personality types, one per line.",value:s,onChange:function(e){a({personalityTypes:e})}}),i.map(((o,l)=>(0,e.createElement)("div",{key:l},(0,e.createElement)(n.TextControl,{value:o.question,onChange:e=>function(e,t){const n=[...i];n[t].question=e,a({questions:n})}(e,l),label:`Question ${l+1}`}),(0,e.createElement)(t.MediaUploadCheck,null,(0,e.createElement)(t.MediaUpload,{onSelect:e=>function(e,t){const n=[...i];n[t].imageUrl=e.url,a({questions:n})}(e,l),allowedTypes:["image"],render:({open:t})=>(0,e.createElement)(n.Button,{onClick:t,isSecondary:!0},o.imageUrl?"Change Image":"Upload Image")})),o.imageUrl&&(0,e.createElement)("img",{src:o.imageUrl,alt:`Uploaded for question ${l+1}`}),o.choices.map(((o,r)=>(0,e.createElement)(n.Flex,{key:r},(0,e.createElement)(n.FlexBlock,null,(0,e.createElement)(n.TextControl,{value:o.text,onChange:e=>function(e,t,n){const o=[...i];o[e].choices[t].text=n,a({questions:o})}(l,r,e),label:"Choice Text"}),(0,e.createElement)(n.SelectControl,{label:"Personality Type",value:o.personalityType,options:s.map((e=>({label:e,value:e}))),onChange:e=>function(e,t,n){const o=[...i];o[e].choices[t].personalityType=n,a({questions:o})}(l,r,e)}),(0,e.createElement)(t.MediaUploadCheck,null,(0,e.createElement)(t.MediaUpload,{onSelect:e=>function(e,t,n){const o=[...i];o[t].choices[n].imageUrl=e.url,a({questions:o})}(e,l,r),allowedTypes:["image"],render:({open:t})=>(0,e.createElement)(n.Button,{onClick:t,isSecondary:!0},o.imageUrl?"Change Image":"Upload Image")})),o.imageUrl&&(0,e.createElement)("img",{src:o.imageUrl,alt:`Image for choice ${r+1} of question ${l+1}`})),(0,e.createElement)(n.FlexItem,null,(0,e.createElement)(n.Button,{isSecondary:!0,onClick:()=>function(e,t){const n=[...i];n[e].choices=n[e].choices.filter(((e,n)=>n!==t)),a({questions:n})}(l,r)},"Delete"))))),(0,e.createElement)(n.Button,{className:"choice-btn",onClick:()=>function(e){const t=[...i];t[e].choices.push({text:"",personalityType:"",imageUrl:""}),a({questions:t})}(l),isSecondary:!0},"Add Another Choice"),(0,e.createElement)("hr",{className:"next-question-line"})))),(0,e.createElement)(n.Button,{onClick:function(){const e=[...i,{question:"",choices:[{text:"",personalityType:"",imageUrl:""}],imageUrl:""}];a({questions:e})},isPrimary:!0},"Add Question"))},save:function(){return null}})})();